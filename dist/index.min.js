(()=>{"use strict";var e=Object.defineProperty,t=(t,r,a)=>(((t,r,a)=>{r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a})(t,"symbol"!=typeof r?r+"":r,a),a),r="undefined"==typeof performance?()=>Date.now():()=>performance.now(),a=class extends Error{code;message;name;statusCode=0;constructor(e="Something went wrong",t){super(),this.message=e,this.code=t,this.name=this.constructor.name}},s={BenchmarkError:a,BeforeEachError:class extends a{statusCode=1;name="BeforeEachError"},AfterEachError:class extends a{statusCode=2;name="AfterEachError"},RunError:class extends a{statusCode=3;name="RunError"},AfterError:class extends a{statusCode=4;name="AfterError"},BeforeError:class extends a{statusCode=5;name="BeforeError"},FatalError:class extends a{statusCode=7;name="FatalError"}},i=(e=>(e.MeanTime="meanTime",e.MedianTime="medianTime",e.StandardDeviation="standardDeviation",e.MaxTime="maxTime",e.MinTime="minTime",e.Hz="hz",e.RunTime="runTime",e.Cycles="cycles",e.Percent="percent",e))(i||{});function n(e,t,r){let a=new s[r](t);a.stack=e.stack;for(let t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);return a}function m(e){return"AsyncFunction"===e.constructor.name}async function o(e,t,r,...a){if(r)try{await r.bind(e)(...a)}catch(a){return n(a,`Benchmark \`${e.name}\` failed to run \`${r.name}\` callback: ${a.message}`,t)}}var c=class{name;error;cycles=0;samples=0;hz=0;meanTime=0;medianTime=0;standardDeviation=0;maxTime=0;minTime=0;times=[];options;stamp;runTime=0;totalTime=0;constructor(e,t,r={}){this.name=e;let a={...c.defaults,...r};"function"==typeof t?a.fn=t:a={...a,...t},this.options=a}toJSON(){const{name:e,error:t,cycles:r,hz:a,runTime:s,totalTime:i,samples:n,meanTime:m,medianTime:o,standardDeviation:c,maxTime:h,minTime:l}=this;return{name:e,errorMessage:t?t.message:void 0,cycles:r,samples:n,hz:a,meanTime:m,medianTime:o,standardDeviation:c,maxTime:h,minTime:l,runTime:s,totalTime:i}}compareWith(e,t="percent"){const{error:r,cycles:a,hz:s,meanTime:i,medianTime:n,standardDeviation:m,maxTime:o,minTime:c,runTime:h}=this;if(r)return-1;if(e.error)return 1;switch(t){case"meanTime":return e.meanTime-i;case"medianTime":return e.medianTime-n;case"standardDeviation":return m-e.standardDeviation;case"maxTime":return o-e.maxTime;case"minTime":return e.minTime-c;case"hz":return s-e.hz;case"runTime":return h-e.runTime;case"cycles":return a-e.cycles;case"percent":return Math.trunc(100*(100/i*e.meanTime-100))/100;default:throw new Error(`Unknown compare field: ${t}`)}}async runSample(){const{beforeEach:e,afterEach:t,fn:a}=this.options;let s=r();for(;r()-s<1e3;){const s=r();this.cycles++;const i=await o(this,"BeforeEachError",e);if(i)throw i;let c;try{if(m(a)){let e=r();await a(),c=r()-e}else{let e=r();a(),c=r()-e}}catch(e){throw n(e,`Benchmark \`${this.name}\` failed to run \`fn\`: ${e.message}`,"RunError")}this.times.push(c),this.runTime+=c;const h=await o(this,"AfterEachError",t);if(h)throw h;this.totalTime+=r()-s}}async run(){this.stamp=r();const{maxTime:e,minSamples:t,after:a,before:s,onError:i}=this.options;let n=1e3*e;try{const e=await o(this,"BeforeError",s);if(e)throw e;for(;this.samples<t||this.totalTime<n;)this.samples++,await this.runSample();this.hz=this.cycles/(this.runTime/1e3),this.meanTime=this.runTime/this.times.length,this.medianTime=this.times.sort((e,t)=>e-t)[Math.floor(this.times.length/2)]||0,this.standardDeviation=Math.sqrt(this.times.map(e=>Math.pow(e-this.meanTime,2)).reduce((e,t)=>e+t,0)/this.times.length),this.maxTime=this.times.reduce((e,t)=>Math.max(e,t),0),this.minTime=this.times.reduce((e,t)=>Math.min(e,t),1/0);const r=await o(this,"AfterError",a);if(r)throw r}catch(e){this.error=e;const t=await o(this,"FatalError",i,e);if(t)throw t}}},h=c;t(h,"Suite"),t(h,"version","2.0.0"),t(h,"defaults",{maxTime:5,minSamples:1});var l=class{name;error;options;stamp;runTime=0;totalTime=0;benchmarks=[];constructor(e,t={}){this.name=e,this.options={...l.defaults,...t}}toJSON(){const{error:e,name:t,runTime:r,totalTime:a}=this;return{name:t,errorMessage:e?e.message:void 0,runTime:r,totalTime:a,passed:!e,benchmarks:this.getSortedBenchmarksBy("meanTime").map(e=>e.toJSON())}}add(e,t,r={}){let a={minSamples:this.options.minSamples,maxTime:this.options.maxTime,...r};"function"==typeof t?a.fn=t:a={...a,...t};let s=new h(e,a);return this.benchmarks.push(s),s}async run(){this.stamp=r();const{beforeEach:e,afterEach:t,after:a,before:s,onError:i}=this.options;try{const r=await o(this,"BeforeError",s);if(r)throw r;for(let r=0,a=this.benchmarks.length;r<a;r++){let a=this.benchmarks[r];const s=await o(this,"BeforeEachError",e,a,r);if(s)throw s;await a.run(),this.runTime+=a.runTime,this.totalTime+=a.totalTime;const i=await o(this,"AfterEachError",t,a,r);if(i)throw i}const i=await o(this,"AfterError",a);if(i)throw i}catch(e){this.error=e;const t=await o(this,"FatalError",i,e);if(t)throw t}}getSortedBenchmarksBy(e){return this.benchmarks.slice().sort((t,r)=>{let a=r.compareWith(t,e);return a>0?1:a<0?-1:0})}getFastest(e){return this.getSortedBenchmarksBy(e)[0]}getSlowest(e){const t=this.getSortedBenchmarksBy(e);return t[t.length-1]}compareFastestWithSlowest(e){let t="percent"===e?"meanTime":e;const r=this.getFastest(t),a=this.getSlowest(t);return{fastest:r,slowest:a,by:r.compareWith(a,e)}}},u=l;t(u,"defaults",{maxTime:5,minSamples:1}),h.Suite=u;var f={Benchmark:h,CompareBy:i};"undefined"!=typeof module?module.exports=f:self.Benchmark=f})();